import osimport Update_Sheetfrom ICS_Shared_Config import ICS_Shared_Configfrom  datetime import datetimeimport timeif __name__ == "__main__":    # use creds to create a client to interact with the Google Drive API    ''' Here is the Initialization for setting path        now it is moved to the ICS_Shared_Config '''    ICS_Shared_Config.Initialization()    ics_config = ICS_Shared_Config.Config()    file_running_path = ics_config.run_file()    sleep_time = ics_config.sleep()    running_file = open(file_running_path, 'w')    running_file.write("1")    running_file.close()    ICS_Shared_Config.Gspread_Client(True)    timeout = ics_config.timeout()    try:        Update_Sheet.ICS_Monitor_POP().generate_criteria()        Update_Sheet.ICS_Monitor_Remote().generate_criteria()        Update_Sheet.ICS_Monitor_POP_SSL().generate_criteria()        for new_thread in Update_Sheet.ICS_Monitor_Http.PreparingTester():            new_thread.generate_criteria()    except Exception as  e:        ICS_Shared_Config.log(os.path.basename(__file__) + " : " + str(e))        ICS_Shared_Config.log("UPDATE CRITERIA FAILED")    while True:        try:            ICS_Shared_Config.log("Testing HTTP, Email and RDP : Start Test")            threads = [] # type: list[Thread]            new_thread = Update_Sheet.ICS_Monitor_POP()            threads.append(new_thread)            new_thread.start()            new_thread = Update_Sheet.ICS_Monitor_Remote()            threads.append(new_thread)            new_thread.start()            time.sleep(3)            new_thread = Update_Sheet.ICS_Monitor_POP_SSL()            threads.append(new_thread)            new_thread.start()            for new_thread in Update_Sheet.ICS_Monitor_Http.PreparingTester():                threads.append(new_thread)                new_thread.start()            total_sleep = 0            while len(threads)>0 and total_sleep<=timeout :                for each_thread in threads:                    if not each_thread.isAlive():                        threads.remove(each_thread)                time.sleep(10)                total_sleep+=10                if (total_sleep>=timeout):                    ICS_Shared_Config.log("Testing  HTTP, Email and RDP: Pass Timeout")                    for each_thread in threads:                        each_thread._stop()                        threads.remove(each_thread)            ICS_Shared_Config.log("Testing  HTTP, Email and RDP: Delay test")            time.sleep(sleep_time)            if not os.path.isfile(file_running_path):                break        except Exception as  e:            ICS_Shared_Config.log(os.path.basename(__file__) + " : " +  str(e))            ICS_Shared_Config.Gspread_Client(True)    ICS_Shared_Config.log(datetime.now().strftime("%Y-%m-%d %H:%M:%S") + " Testing Email : terminated ")    input() 