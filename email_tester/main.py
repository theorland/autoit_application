import sysfrom oauth2client.service_account import ServiceAccountCredentialsimport gspreadimport osimport sysfrom Update_Sheet import ICS_Monitorfrom ICS_Config import ICS_Configfrom  datetime import datetimeimport timeif __name__ == "__main__":    # use creds to create a client to interact with the Google Drive API    scope = ['https://spreadsheets.google.com/feeds', \             'https://www.googleapis.com/auth/drive']    application_path = "."    if getattr(sys, 'frozen', False):        application_path = os.path.dirname(sys.executable)    elif __file__:        application_path = os.path.dirname(__file__)    print("Testing Email: application path " + application_path)    client_secret_json_path = os.path.join(application_path ,'client_secret.json')    ICS_Config.Current_Setting_Path = os.path.join(application_path ,'email_tester.ini')    print ("Testing Email: setting file in " + client_secret_json_path)    print ("Testing Email: setting file in " + ICS_Config.Current_Setting_Path)    key_input = ""    file_running_path = ICS_Config().run_file()    sleep_time = float(ICS_Config().sleep())    running_file = open(file_running_path, 'w')    running_file.write("1")    running_file.close()    creds = ServiceAccountCredentials.from_json_keyfile_name(client_secret_json_path, scope)    client = gspread.authorize(creds)    while True:        print (datetime.now().strftime("%Y-%m-%d %H:%M:%S") + " Testing Email : Start Test " )        try:            monitorApp = ICS_Monitor(client)            monitorApp.test_email()            key_input = ""            time.sleep(sleep_time)        except:            creds = ServiceAccountCredentials.from_json_keyfile_name(\                client_secret_json_path, scope)            client = gspread.authorize(creds)            print  datetime.now().strftime("%Y-%m-%d %H:%M:%S")+  " Refresh the token"        if not os.path.isfile(file_running_path):            break    print datetime.now().strftime("%Y-%m-%d %H:%M:%S") + " Testing Email : terminated "    input()